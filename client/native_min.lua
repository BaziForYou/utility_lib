_G["ESX"],_G["xPlayer"],_G["source"],_G["developer"]=nil,{},GetPlayerServerId(PlayerId()),function()end;local a,b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t=AddTextEntry,BeginTextCommandDisplayHelp,EndTextCommandDisplayHelp,SetNotificationTextEntry,AddTextComponentSubstringPlayerName,DrawNotification,GetEntityCoords,World3dToScreen2d,SetTextScale,SetTextFont,SetTextEntry,SetTextCentre,AddTextComponentString,DrawText,DoesEntityExist,GetDistanceBetweenCoords,GetPlayerPed,TriggerEvent,TriggerServerEvent;local u=GetCurrentResourceName()local v={["ESC"]=322,["F1"]=288,["F2"]=289,["F3"]=170,["F5"]=166,["F6"]=167,["F7"]=168,["F8"]=169,["F9"]=56,["F10"]=57,["~"]=243,["1"]=157,["2"]=158,["3"]=160,["4"]=164,["5"]=165,["6"]=159,["7"]=161,["8"]=162,["9"]=163,["-"]=84,["="]=83,["BACKSPACE"]=177,["TAB"]=37,["Q"]=44,["W"]=32,["E"]=38,["R"]=45,["T"]=245,["Y"]=246,["U"]=303,["P"]=199,["["]=39,["]"]=40,["ENTER"]=18,["CAPS"]=137,["A"]=34,["S"]=8,["D"]=9,["F"]=23,["G"]=47,["H"]=74,["K"]=311,["L"]=182,["LEFTSHIFT"]=21,["Z"]=20,["X"]=73,["C"]=26,["V"]=0,["B"]=29,["N"]=249,["M"]=244,[","]=82,["."]=81,["LEFTCTRL"]=36,["LEFTALT"]=19,["SPACE"]=22,["RIGHTCTRL"]=70,["HOME"]=213,["PAGEUP"]=10,["PAGEDOWN"]=11,["DELETE"]=178,["LEFT"]=174,["RIGHT"]=175,["TOP"]=27,["DOWN"]=173,["NENTER"]=201,["N4"]=108,["N5"]=60,["N6"]=107,["N+"]=96,["N-"]=97,["N7"]=117,["N8"]=61,["N9"]=118}_G["Utility"]={Cache={PlayerPedId=PlayerPedId(),Marker={},Object={},Dialogue={},N3d={},Emitter={},SetData={},Frozen={},FlowDetector={},Constant={},Loop={},SliceGroups={}}}On=function(type,w,x)if string.find(type,"_change")then type=type..source end;local y={res=u,a=w,b=x}s("Utility:Create","Emitter",type,y,u)end;_G.old_TaskVehicleDriveToCoord=TaskVehicleDriveToCoord;TaskVehicleDriveToCoord=function(z,A,B,C,D)old_TaskVehicleDriveToCoord(z,A,B,C or 10.0,0,GetEntityModel(A),2883621,D or 1.0)end;_G.old_DisableControlAction=DisableControlAction;DisableControlAction=function(E,F)return old_DisableControlAction(0,v[string.upper(E)],true or F)end;DisableControlForSeconds=function(E,G)local H=G;Citizen.CreateThread(function()while H>0 do Citizen.Wait(1000)H=H-1 end;return end)Citizen.CreateThread(function()while H>0 do DisableControlAction(v[string.upper(E)])Citizen.Wait(1)end;return end)end;_G.old_IsControlJustPressed=IsControlJustPressed;IsControlJustPressed=function(I,J)developer("^2Created^0","key map",I)RegisterKeyMapping('utility '..I,'',"keyboard",I)AddEventHandler("Utility:Pressed_"..I,J)end;ShowNotification=function(K)d('STRING')e(K)f(false,true)end;ButtonNotification=function(K)if string.match(K,"{.*}")then K=string.multigsub(K,{"{A}","{B}","{C}","{D}","{E}","{F}","{G}","{H}","{L}","{M}","{N}","{O}","{P}","{Q}","{R}","{S}","{T}","{U}","{V}","{W}","{X}","{Y}","{Z}"},{"~INPUT_VEH_FLY_YAW_LEFT~","~INPUT_SPECIAL_ABILITY_SECONDARY~","~INPUT_LOOK_BEHIND~","~INPUT_MOVE_LR~","~INPUT_CONTEXT~","~INPUT_ARREST~","~INPUT_DETONATE~","~INPUT_VEH_ROOF~","~INPUT_CELLPHONE_CAMERA_FOCUS_LOCK~","~INPUT_INTERACTION_MENU~","~INPUT_REPLAY_ENDPOINT~","~INPUT_FRONTEND_PAUSE~","~INPUT_FRONTEND_LB~","~INPUT_RELOAD~","~INPUT_MOVE_DOWN_ONLY~","~INPUT_MP_TEXT_CHAT_ALL~","~INPUT_REPLAY_SCREENSHOT~","~INPUT_NEXT_CAMERA~","~INPUT_MOVE_UP_ONLY~","~INPUT_VEH_HOTWIRE_LEFT~","~INPUT_VEH_DUCK~","~INPUT_MP_TEXT_CHAT_TEAM~","~INPUT_HUD_SPECIAL~"})end;a('ButtonNotification',K)b('ButtonNotification')c(0,false,true,-1)end;FloatingNotification=function(K,L)a('FloatingNotification',K)SetFloatingHelpTextWorldPosition(1,L)SetFloatingHelpTextStyle(1,1,2,-1,3,0)b('FloatingNotification')c(2,false,false,-1)end;MakeEntityFaceEntity=function(M,N,O)local P=g(M,true)local Q=g(N,true)if O then local R=GetHeadingFromVector_2d(Q.x-P.x,Q.y-P.y)SetEntityHeading(M,R)else local R=GetHeadingFromVector_2d(P.x-Q.x,P.y-Q.y)SetEntityHeading(N,R)end end;DrawText3Ds=function(L,S,T,U,V)local W,X,Y=h(L.x,L.y,L.z)if W then i(T or 0.35,T or 0.35)j(U or 4)k("STRING")l(1)m(S)o(X,Y)if V then local Z=string.len(S)/370;local _,a0=string.gsub(Z,"\n","\n")*0.025;if a0==nil then a0=0 end;DrawRect(X,Y+0.0125,0.025+Z,0.025+a0,0,0,0,90)end end end;_G.old_TaskPlayAnim=TaskPlayAnim;TaskPlayAnim=function(z,a1,...)if not HasAnimDictLoaded(a1)then RequestAnimDict(a1)while not HasAnimDictLoaded(a1)do Citizen.Wait(1)end end;old_TaskPlayAnim(z,a1,...)RemoveAnimDict(a1)end;_G.old_CreateObject=CreateObject;CreateObject=function(a2,...)if type(a2)=="string"then a2=GetHashKey(a2)end;if not HasModelLoaded(a2)then RequestModel(a2)while not HasModelLoaded(a2)do Citizen.Wait(1)end end;local a3=old_CreateObject(a2,...)SetModelAsNoLongerNeeded(a2)local a4=0;if NetworkGetEntityIsNetworked(a3)then a4=ObjToNet(a3)SetNetworkIdExistsOnAllMachines(a4,true)SetNetworkIdCanMigrate(a4,true)end;return a3,a4 end;_G.old_CreatePed=CreatePed;CreatePed=function(a2,...)if type(a2)=="string"then a2=GetHashKey(a2)end;if not HasModelLoaded(a2)then RequestModel(a2)while not HasModelLoaded(a2)do Citizen.Wait(1)end end;local z=old_CreatePed(0,a2,...)SetModelAsNoLongerNeeded(a2)local a4=0;if NetworkGetEntityIsNetworked(z)then a4=PedToNet(z)SetNetworkIdExistsOnAllMachines(a4,true)SetNetworkIdCanMigrate(a4,true)end;return z,a4 end;_G.old_CreateVehicle=CreateVehicle;CreateVehicle=function(a2,...)if type(a2)=="string"then a2=GetHashKey(a2)end;if not HasModelLoaded(a2)then RequestModel(a2)while not HasModelLoaded(a2)do Citizen.Wait(1)end end;local a5=old_CreateVehicle(a2,...)SetModelAsNoLongerNeeded(a2)local a4=0;if NetworkGetEntityIsNetworked(a5)then a4=VehToNet(a5)SetNetworkIdExistsOnAllMachines(a4,true)SetNetworkIdCanMigrate(a4,true)end;return a5,a4 end;_G.old_DeleteEntity=DeleteEntity;DeleteEntity=function(a6,a7)if not a7 then NetworkRequestControlOfEntity(a6)while not NetworkRequestControlOfEntity(a6)do Citizen.Wait(1)end;if not IsEntityAMissionEntity(a6)then SetEntityAsMissionEntity(a6)end;old_DeleteEntity(a6)else NetworkRequestControlOfNetworkId(a6)local a8=NetworkGetEntityFromNetworkId(a6)while not NetworkRequestControlOfEntity(a8)do Citizen.Wait(1)end;SetEntityAsMissionEntity(a8)old_DeleteEntity(a8)end end;_G.old_RegisterNetEvent=RegisterNetEvent;RegisterNetEvent=function(a9,aa)old_RegisterNetEvent(a9)AddEventHandler(a9,aa)end;_G.old_GetPlayerName=GetPlayerName;GetPlayerName=function(ab)return old_GetPlayerName(ab or PlayerId())end;_G.old_PlayerPedId=PlayerPedId;PlayerPedId=function()if not p(Utility.Cache.PlayerPedId)then Utility.Cache.PlayerPedId=old_PlayerPedId()end;return Utility.Cache.PlayerPedId end;StopLoop=function(ab)Utility.Cache.Loop[ab].status=false end;CreateLoop=function(J,ac,ad)local ae=RandomId(5)Utility.Cache.Loop[ae]={status=true,func=J,tick=ac}if ad~=false then Citizen.CreateThread(function()while Utility.Cache.Loop[ae]and Utility.Cache.Loop[ae].status do J(ae)Citizen.Wait(ac or 1)end end)end;return ae end;PauseLoop=function(ae,af)Citizen.SetTimeout(af or 0,function()print("Pausing loop "..ae)Utility.Cache.Loop[ae].status=false end)end;ResumeLoop=function(ae,af)local ag=Utility.Cache.Loop[ae]Citizen.SetTimeout(af or 0,function()print("Resuming loop "..ae)ag.status=true;Citizen.CreateThread(function()while ag and ag.status do ag.func(ae)Citizen.Wait(ag.tick or 1)end end)end)end;GetWorldClosestPed=function(ah)local ai=0;local aj=GetGamePool("CPed")local L=g(PlayerPedId())local ak=ah+5.0;for al=1,#aj do local am=q(L,g(aj[al]),false)if am<=ah and aj[al]~=PlayerPedId()then if ak>am then ak=am;ai=aj[al]end end end;return ai,aj end;GetWorldClosestPlayer=function(ah)local ai=0;local an={}local ak=ah+5.0;local aj=GetGamePool("CPed")local L=g(PlayerPedId())for al=1,#aj do if IsPedAPlayer(aj[al])then table.insert(an,NetworkGetPlayerIndexFromPed(aj[al]))local am=q(L,g(aj[al]),false)if am<=ah and aj[al]~=PlayerPedId()then if ak>am then ak=am;ai=NetworkGetPlayerIndexFromPed(aj[al])end end end end;return ai,an end;GetEntitySurfaceMaterial=function(a6)local L=GetEntityCoords(a6)local ao=StartShapeTestCapsule(L.x,L.y,L.z,L.x,L.y,L.z-2.5,2,1,a6,7)local _,ap,_,_,aq=GetShapeTestResultIncludingMaterial(ao)return aq,ap end;GetLoadoutOfPed=function(z)local ar=ESX.GetWeaponList()local as={}for al=1,#ar,1 do local hash=GetHashKey(ar.name)if HasPedGotWeapon(z,hash,false)then table.insert(as,{name=ar.name,hash=hash,ammo=GetAmmoInPedWeapon(z,hash)})end end;return as end;local at=FreezeEntityPosition;FreezeEntityPosition=function(a6,au)Utility.Cache.Frozen[a6]=au;at(a6,au)end;IsEntityFrozen=function(a6)return Utility.Cache.Frozen[a6]==true end;GetNearestValue=function(av,aw)local ax=100*100000000000;local ay=0;for al=1,#aw do local az=math.abs(aw[al]-av)if az<ax then ax=az;n=aw[al]ay=al end end;return n,ax,ay end;TriggerSyncedEvent=function(aA,aB,...)if type(aB)=="number"or type(aB)=="table"then if aB==-1 then t("Utility:SyncEvent",aA,"",...)else t("Utility:SyncEvent",aA,aB,...)end else developer("^1Error^0","you can use only number/table on whitelist of TriggerSyncedEvent","")end end;StartESX=function(a9,aC)Citizen.CreateThreadNow(function()while ESX==nil do TriggerEvent(a9 or'esx:getSharedObject',function(a3)ESX=a3 end)Citizen.Wait(1)end;while ESX.GetPlayerData().job==nil do Citizen.Wait(1)end;xPlayer=ESX.GetPlayerData()if aC~=nil then while ESX.GetPlayerData()[aC]==nil do Citizen.Wait(1)end;xPlayer=ESX.GetPlayerData()end;if aC~=nil then RegisterNetEvent('esx:set'..string.upper(aC:sub(1,1))..aC:sub(2),function(aD)xPlayer[aC]=aD end)end;RegisterNetEvent('esx:setJob',function(aD)xPlayer.job=aD end)end)end;StartQB=function(aE)QBCore=exports['qb-core']:GetCoreObject()end;GetDataForJob=function(aD)local aF=promise:new()if GetResourceState("qb-core")=="started"then ESX.TriggerServerCallback("Utility:GetJobData",function(aG)aF:resolve(aG)end,aD)elseif GetResourceState("es_extended")=="started"then QBCore.Functions.TriggerCallback("Utility:GetJobData",function(aG)aF:resolve(aG)end,aD)end;aF=Citizen.Await(aF)return#aF,aF end;local aH=0;GetOnHandObject=function()return aH end;TakeObjectOnHand=function(z,aI,aJ,aK,aL,aM,aN,aO,aP)developer("^2Taking^0","object",aI.." ("..GetEntityModel(aI)..")")if type(aI)=="number"then TaskPlayAnim(z,"anim@heists@box_carry@","idle",3.0,3.0,-1,63,0,0,0,0)Citizen.Wait(100)AttachEntityToEntity(aI,z,GetPedBoneIndex(z,60309),aK or 0.2,aL or 0.08,aM or 0.2,aN or-45.0,aO or 290.0,aP or 0.0,true,true,false,true,1,true)aH=aI elseif type(aI)=="string"then local L=g(z)local aQ=CreateObject(aI,L+vector3(0.0,0.0,aJ or 0.2),true,false,false)SetEntityAsMissionEntity(aQ)TaskPlayAnim(z,"anim@heists@box_carry@","idle",3.0,-8,-1,63,0,0,0,0)Citizen.Wait(100)AttachEntityToEntity(aQ,z,GetPedBoneIndex(z,60309),aK or 0.2,aL or 0.08,aM or 0.2,aN or-45.0,aO or 290.0,aP or 0.0,true,true,false,true,1,true)aH=aQ;return aQ end end;DropObjectFromHand=function(aR,aS)if aS then developer("^1Deleting^0","from hand",aR)DeleteEntity(aR)else developer("^3Dont delete^0","from hand",aR)DetachEntity(aR)SetEntityCoords(aR,GetOffsetFromEntityInWorldCoords(aR,0,0.5,0))PlaceObjectOnGroundProperly(aR)FreezeEntityPosition(aR,true)end;ClearPedTasks(PlayerPedId())aH=0 end;IsInRadius=function(P,Q,ah,aT)local am=#(P-Q)if aT then DrawSphere(Q,ah,255,0,0,0.5)end;return am<ah end;IsNearCoords=function(L,ah,aT)local am=#(GetEntityCoords(PlayerPedId())-L)if aT then DrawSphere(L,ah,255,0,0,0.5)end;return am<ah end;GenerateRandomCoords=function(L,ah,R)local aU=L.x+math.random(-ah,ah)local aV=L.y+math.random(-ah,ah)local _,aW=GetGroundZFor_3dCoord(aU,aV,200.0,0)if R then return vector3(aU,aV,aW),math.random(0.0,360.0)end;return vector3(aU,aV,aW)end;SetFor=function(ab,aX,aY)if Utility.Cache["SetData"][ab]==nil then Utility.Cache["SetData"][ab]={}end;if type(aX)=="table"then for aZ,av in pairs(aX)do developer("^2Setting^0","data","("..ab..") ["..aZ.." = "..json.encode(av).."] {table}")Utility.Cache["SetData"][ab][aZ]=av end else developer("^2Setting^0","data","("..ab..") ["..aX.." = "..json.encode(aY).."] {single}")Utility.Cache["SetData"][ab][aX]=aY end end;GetFrom=function(ab,aX)if aX==nil then aX="not defined"end;developer("^3Getting^0","data","("..ab..") ["..aX.."]")if Utility.Cache["SetData"][ab]~=nil then if aX=="not defined"then return Utility.Cache["SetData"][ab]else return Utility.Cache["SetData"][ab][aX]end else return nil end end;function GetSliceCoordsFromCoords(a_)return vector2(math.floor((a_.x+8192)/100),math.floor((a_.y+8192)/100))end;function GetSliceFromCoords(b0)local b1=GetSliceCoordsFromCoords(b0)local ab=b1.x*math.pow(2,2)+b1.y;return ab end;function GetEntitySlice(z)return GetSliceFromCoords(GetEntityCoords(z))end;function GetPlayerSlice(b2)local z=GetPlayerPed(b2)return GetSliceFromCoords(GetEntityCoords(z))end;function GetSelfSlice()local z=PlayerPedId()return GetSliceFromCoords(GetEntityCoords(z))end;function IsOnScreen(L)local W,X,Y=World3dToScreen2d(L.x,L.y,L.z)return W end;function SliceUsed(b1)return Utility.Cache.SliceGroups[b1]or false end;function SetSliceUsed(b1,aY)Utility.Cache.SliceGroups[b1]=aY end;RandomId=function(b3)b3=b3 or 5;local b4=""for al=1,b3 do b4=b4 .."9"end;return math.random(0,b4)end;CreateMarker=function(ab,L,b5,b6,b7)if DoesExist("m",ab)then Citizen.Wait(100)return else if type(L)~="vector3"then developer("^1Error^0","You can use only vector3 for coords!",ab)return end;ab=string.gsub(ab,"{r}",RandomId())developer("^2Created^0","Marker",ab)local b8={render_distance=b5,interaction_distance=b6,coords=L,slice=tostring(GetSliceFromCoords(L))}if type(b7)=="table"then if b7.rgb~=nil then b8.type=1;b8.rgb=b7.rgb elseif b7.text~=nil then b8.type=0;b8.text=b7.text;s("Utility:Create","Marker",ab,b8)return else b8.type=1;b8.rgb={b7[1],b7[2],b7[3]}s("Utility:Create","Marker",ab,b8)return end;if b7.type~=nil and type(b7.type)=="number"then b8._type=b7.type end;if b7.direction~=nil and type(b7.direction)=="vector3"then b8._direction=b7.direction end;if b7.rotation~=nil and type(b7.rotation)=="vector3"then b8._rot=b7.rotation end;if b7.scale~=nil and type(b7.scale)=="vector3"then b8._scale=b7.scale end;if b7.alpha~=nil and type(b7.alpha)=="number"then b8.alpha=b7.alpha end;if b7.animation~=nil and type(b7.animation)=="boolean"then b8.anim=b7.animation end;if b7.notify~=nil then local b9=string.multigsub(b7.notify,{"{A}","{B}","{C}","{D}","{E}","{F}","{G}","{H}","{L}","{M}","{N}","{O}","{P}","{Q}","{R}","{S}","{T}","{U}","{V}","{W}","{X}","{Y}","{Z}"},{"~INPUT_VEH_FLY_YAW_LEFT~","~INPUT_SPECIAL_ABILITY_SECONDARY~","~INPUT_LOOK_BEHIND~","~INPUT_MOVE_LR~","~INPUT_CONTEXT~","~INPUT_ARREST~","~INPUT_DETONATE~","~INPUT_VEH_ROOF~","~INPUT_CELLPHONE_CAMERA_FOCUS_LOCK~","~INPUT_INTERACTION_MENU~","~INPUT_REPLAY_ENDPOINT~","~INPUT_FRONTEND_PAUSE~","~INPUT_FRONTEND_LB~","~INPUT_RELOAD~","~INPUT_MOVE_DOWN_ONLY~","~INPUT_MP_TEXT_CHAT_ALL~","~INPUT_REPLAY_SCREENSHOT~","~INPUT_NEXT_CAMERA~","~INPUT_MOVE_UP_ONLY~","~INPUT_VEH_HOTWIRE_LEFT~","~INPUT_VEH_DUCK~","~INPUT_MP_TEXT_CHAT_TEAM~","~INPUT_HUD_SPECIAL~"})b8.notify=b9 end elseif type(b7)=="string"then b8.type=0;b8.text=b7 end;Utility.Cache.Marker[ab]=b8;s("Utility:Create","Marker",ab,b8)end end;SetMarkerType=function(ab,ba)if type(ba)~="number"then developer("^1Error^0","Type can be only a number","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab]._type=ba;s("Utility:Edit","Marker",ab,"_type",ba)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerDirection=function(ab,bb)if type(bb)~="vector3"then developer("^1Error^0","Direction can be only a vector3","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab]._direction=bb;s("Utility:Edit","Marker",ab,"_direction",bb)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerRotation=function(ab,bc)if type(bc)~="vector3"then developer("^1Error^0","Rotation can be only a vector3","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab]._rot=bc;s("Utility:Edit","Marker",ab,"_rot",bc)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerScale=function(ab,T)if type(T)~="vector3"then developer("^1Error^0","Scale can be only a vector3","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab]._scale=T;s("Utility:Edit","Marker",ab,"_scale",T)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerColor=function(ab,bd)if type(bd)~="table"then developer("^1Error^0","Color can be only a vector3","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab].rgb=bd;s("Utility:Edit","Marker",ab,"rgb",bd)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerAlpha=function(ab,be)if type(be)~="number"then developer("^1Error^0","Alpha can be only a number","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab].alpha=be;s("Utility:Edit","Marker",ab,"alpha",be)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerAnimation=function(ab,au)if type(au)~="boolean"then developer("^1Error  ^0","Animation can be only a boolean (true/false)","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab].anim=au;s("Utility:Edit","Marker",ab,"anim",au)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerDrawOnEntity=function(ab,au)if type(au)~="boolean"then developer("^1Error^0","Draw on entity can be only a boolean (true/false)","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab].draw_entity=au;s("Utility:Edit","Marker",ab,"draw_entity",au)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;Set3dTextScale=function(ab,T)if type(T)~="number"then developer("^1Error^0","Marker scale can be only a number","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab]._scale=T;s("Utility:Edit","Marker",ab,"_scale",T)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;Set3dTextDrawRect=function(ab,au)if type(au)~="boolean"then developer("^1Error^0","Marker rect can be only a boolean (true/false)","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab].rect=au;s("Utility:Edit","Marker",ab,"rect",au)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;Set3dTextFont=function(ab,U)if type(U)~="number"then developer("^1Error^0","Marker font can be only a number","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab].font=U;s("Utility:Edit","Marker",ab,"font",U)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;DeleteMarker=function(ab)if not DoesExist("m",ab)then Citizen.Wait(100)return else developer("^1Deleted^0","Marker",ab)Utility.Cache.Marker[ab]=nil;s("Utility:Remove","Marker",ab)end end;CreateiObject=function(ab,bf,b0,R,b6,bg)developer("^2Created^0 Object "..ab.." ("..bf..")")local a3;if bg~=nil then a3=CreateObject(GetHashKey(bf),b0.x,b0.y,b0.z,bg,false,false)or nil else a3=CreateObject(GetHashKey(bf),b0.x,b0.y,b0.z,true,false,false)or nil end;SetEntityHeading(a3,R)SetEntityAsMissionEntity(a3,true,true)FreezeEntityPosition(a3,true)SetModelAsNoLongerNeeded(hash)_object={obj=a3,coords=b0,interaction_distance=b6 or 3.0,slice=tostring(GetSliceFromCoords(b0))}Utility.Cache.Object[ab]=_object;s("Utility:Create","Object",ab,_object)return a3,g(a3)end;DeleteiObject=function(ab,aS)developer("^1Deleted^0","Object",ab)if aS then DeleteEntity(Utility.Cache.Object[ab].obj)end;Utility.Cache.Object[ab]=nil;s("Utility:Remove","Object",ab)end;CreateBlip=function(bh,L,bi,bj,T)developer("^2Created^0","Blip",bh)local bk=AddBlipForCoord(L)SetBlipSprite(bk,bi)SetBlipScale(bk,T or 1.0)SetBlipColour(bk,bj)SetBlipAsShortRange(bk,true)BeginTextCommandSetBlipName('STRING')e(bh)EndTextCommandSetBlipName(bk)return bk end;SetIdOf=function(type,ab,bl)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if DoesExist(type,ab)then Utility.Cache[type][bl]=Utility.Cache[type][ab]Utility.Cache[type][ab]=nil else developer("^1Error^0","Unable to set id of the "..type.." as it does not exist",ab)return end;developer("^3Change^0","Setted id to "..bl.." of the id",ab)s("Utility:Remove",type,ab)s("Utility:Create",type,bl,Utility.Cache[type][bl])end;SetTextOf=function(type,ab,bm)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if DoesExist(type,ab)then Utility.Cache[type][ab].text=bm;s("Utility:Edit",type,ab,"text",bm)else developer("^1Error^0","Unable to change text of the "..type.." as it does not exist",ab)return end;developer("^3Change^0","Setted text to "..bm.." of the id",ab)end;GetDistanceFrom=function(type,ab)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;local am=0.0;if Utility.Cache[type][ab].coords~=nil then return q(g(PlayerPedId()),Utility.Cache[type][ab].coords,true)else return false end end;GetCoordOf=function(type,ab)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if DoesExist(type,ab)then return Utility.Cache[type][ab].coords else developer("^1Error^0","Unable to get the coords of the id",ab)return false end end;DoesExist=function(type,ab)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if Utility.Cache[type][ab]~=nil then return true else return false end end;CreateCamera=function(L,bn,au,bo)local bp=CreateCam("DEFAULT_SCRIPTED_CAMERA",true)SetCamCoord(bp,L)if bn~=nil then SetCamRot(bp,bn.x,bn.y,bn.z)end;if bo~=nil then ShakeCam(bp,bo.type or"",bo.amount or 0.0)end;if au then SetCamActive(bp,true)RenderScriptCams(1,1,1500,1,1)end;return bp end;SwitchBetweenCam=function(bq,bp)SetCamActiveWithInterp(bp,bq,1500,1,1)Citizen.Wait(1600)DestroyCam(bq)end;DevMode=function(br,bs,bt)if bs==nil then bs=true end;bt=bt or"%s %s %s"if br then developer=function(bu,type,ab)local _,_,_,bv,bw,bx=GetLocalTime()if bs then if type==nil then print(bv..":"..bw..":"..bx.." - "..bu)else print(bv..":"..bw..":"..bx.." - "..string.format(bt,bu,type,ab))end else if type==nil then print(bu)else print(string.format(bt,bu,type,ab))end end end else developer=function()end end end;ReplaceTexture=function(aQ,by,bz,bA,bB)local bC=CreateRuntimeTxd('duiTxd')local bD=CreateDui(bz,bA,bB)local bE=GetDuiHandle(bD)local bF=CreateRuntimeTextureFromDuiHandle(bC,'duiTex',bE)AddReplaceTexture(aQ,by,'duiTxd','duiTex')end;printd=function(bG,bH)if bH then local bI={}local function bJ(bK,bL)if bI[tostring(bK)]then print(bL.."*"..tostring(bK))else bI[tostring(bK)]=true;if type(bK)=="table"then for b0,bM in pairs(bK)do if type(bM)=="table"then print(bL.."["..b0 .."] => "..tostring(bK).." {")bJ(bM,bL..string.rep(" ",string.len(b0)+8))print(bL..string.rep(" ",string.len(b0)+6).."}")elseif type(bM)=="string"then print(bL.."["..b0 .."] => \""..bM.."\"")else print(bL.."["..b0 .."] => "..tostring(bM))end end else print(bL..tostring(bK))end end end;if type(bG)=="table"then print(tostring(bG).." {")bJ(bG,"  ")print("}")else developer("^1Error^0","error dumping table "..bG.." why isnt a table","")end else if type(bG)=="table"then print(json.encode(bG,{indent=true}))else developer("^1Error^0","error dumping table "..bG.." why isnt a table","")end end end;local bN=string.gsub;string.multigsub=function(string,table,bO)if type(table)then for al=1,#table do string=bN(string,table[al],bO[al])end else for al=1,#table do string=bN(string,table[al],bO)end end;return string end;table.fexist=function(bG,bP)bG=bG[bP]if not bG then return false else return true end end;local bQ=table.remove;table.remove=function(bG,bR,bS)if type(bR)=="number"then bQ(bG,bR)elseif type(bR)=="string"then for aZ,av in pairs(bG)do if aZ==bR then bG[aZ]=nil;if bS then break end end end end end;table.empty=function(bG)return next(bG)==nil end;table.clone=function(bG)bG.metatable={__index=bG}local bT={}setmetatable(bT,bG.metatable)return bT end;local function bU(a6,_dialog,bV)return{Question=function(...)local bW={...}_dialog.questions=bW;return{Response=function(...)local bX={}local bY={}for bZ,b_ in pairs({...})do bY[bZ]={}for aZ,av in pairs(b_)do if bX[bZ]==nil then bX[bZ]=""end;bX[bZ]=bX[bZ]..aZ.."~w~ "..av.." | "aZ=string.multigsub(aZ,{"%[","%]"},{"",""})aZ=string.multigsub(aZ,{"~r~","~b~","~g~","~y~","~p~","~o~","~c~","~m~","~u~","~n~","~s~","~w~"},{"","","","","","","","","","","",""})bY[bZ][aZ]=av end;bX[bZ]=bX[bZ]:sub(1,-3)end;_dialog.response={no_formatted=bY,formatted=bX}if bV then s("Utility:Remove","Dialogue",a6)s("Utility:Create","Dialogue",a6,_dialog)else s("Utility:Create","Dialogue",a6,_dialog)end;Utility.Cache.Dialogue[a6]=_dialog;return{LastQuestion=function(c0)Utility.Cache.Dialogue[a6].lastq=c0;s("Utility:Edit","Dialogue",a6,"lastq",c0)end}end}end}end;StartDialogue=function(a6,am,c1)local _dialog={}_dialog={entity=a6,distance=am,current_question=1,callback=c1,slice=tostring(GetEntitySlice(a6))}developer("^2Created^0","dialogue with entity",a6)return bU(a6,_dialog)end;EditDialogue=function(a6)if a6~=nil and IsEntityOnDialogue(a6)then return bU(a6,_dialog,true)end end;StopDialogue=function(a6)if a6~=nil and IsEntityOnDialogue(a6)then developer("^1Stopping^0","dialogue",a6)if Utility.Cache.Dialogue[a6].lastq~=nil then local c2=0;local c3=Utility.Cache.Dialogue[a6].lastq;local c4=Utility.Cache.Dialogue[a6].entity;local c5=GetEntityCoords(c4)+vector3(0.0,0.0,1.0)CreateLoop(function(ae)LoopThread(ae,1000,function()c5=GetEntityCoords(c4)+vector3(0.0,0.0,1.0)c2=c2+1 end)if c2==3 then _break(ae)end;DrawText3Ds(c5,c3,nil,nil,true)end)end;Utility.Cache.Dialogue[a6]=nil;s("Utility:Remove","Dialogue",a6)end end;RegisterNetEvent("Utility_Native:ResyncDialogue",function(a6)Utility.Cache.Dialogue[a6]=nil end)IsEntityOnDialogue=function(a6)return Utility.Cache.Dialogue[a6]end;local function c6(table)local c7={}print("Copying table "..tostring(table))for aZ,av in pairs(table)do c7[aZ]=av end;return c7 end;CreateLoop(function()for bh,c8 in pairs(Utility.Cache.FlowDetector)do local c9=_G[bh]if type(c9)=='table'or type(c8)=='table'then if json.encode(c8)~=json.encode(c9)then print("\nDetected old_value change of syncedV \""..bh.."\" from \""..json.encode(c8).."\" to \""..json.encode(c9).."\"")TriggerSyncedEvent("Utility:SyncValue_emit",-1,bh,c8,c9)TriggerSyncedEvent("Utility:SyncValue["..u.."]",-1,bh,c9)local c7=c6(c9)Utility.Cache.FlowDetector[bh]=c7 end else if c9~=c8 then TriggerSyncedEvent("Utility:SyncValue_emit",-1,bh,c8,c9)TriggerSyncedEvent("Utility:SyncValue["..u.."]",-1,bh,c9)Utility.Cache.FlowDetector[bh]=c9 end end end end,2000)Synced=function(bh,aY)print("Creating synceV "..bh)if type(aY)=="table"then local c7=c6(aY)Utility.Cache.FlowDetector[bh]=c7;_G[bh]=aY else Utility.Cache.FlowDetector[bh]=aY;_G[bh]=aY end end;RegisterNetEvent("Utility:SyncValue["..u.."]",function(bh,aY)_G[bh]=aY end)local function ca(cb,cc)local cd=RequestScaleformMovie(cc)local c2=100;while not HasScaleformMovieLoaded(cd)and c2>0 do c2=c2-1;cd=RequestScaleformMovie(cc)Citizen.Wait(5)end;if c2==0 then developer("^1Error^0","After 100 attempts to load the scaleform the scaleform has not loaded yet, try again or check that it has started correctly!","")return end;Utility.Cache.N3d[cb].scaleform=cd;s("Utility:Edit","N3d",cb,"scaleform",cd)end;local function ce(cb,bz,bA,bB)local bC=CreateRuntimeTxd('txd')Utility.Cache.N3d[cb].dui=CreateDui(bz,bA,bB)s("Utility:Edit","N3d",cb,"dui",Utility.Cache.N3d[cb].dui)local bE=GetDuiHandle(Utility.Cache.N3d[cb].dui)CreateRuntimeTextureFromDuiHandle(bC,'txn',bE)if Utility.Cache.N3d[cb].scaleform~=nil and not Utility.Cache.N3d[cb].txd then PushScaleformMovieFunction(Utility.Cache.N3d[cb].scaleform,'SET_TEXTURE')PushScaleformMovieMethodParameterString('txd')PushScaleformMovieMethodParameterString('txn')PushScaleformMovieFunctionParameterInt(0)PushScaleformMovieFunctionParameterInt(0)PushScaleformMovieFunctionParameterInt(bA)PushScaleformMovieFunctionParameterInt(bB)PopScaleformMovieFunctionVoid()Utility.Cache.N3d[cb].txd=true;s("Utility:Edit","N3d",cb,"txd",true)end end;function CreateNui3d(cf,bz)local cb=tostring(math.random(0,9999))local cg={txd=false,show=false,rotation={}}Utility.Cache.N3d[cb]=cg;s("Utility:Create","N3d",cb,cg)ca(cb,cf)if bz~=nil then ce(cb,"nui://"..GetCurrentResourceName().."/"..bz,1920,1080)end;local ch={}ch.__index=ch;ch.init=function(self,bz,bA,bB)ce(cb,"nui://"..GetCurrentResourceName().."/"..bz,bA or 1920,bB or 1080)end;ch.scale=function(self,T)Utility.Cache.N3d[cb].advanced_scale=T;s("Utility:Edit","N3d",cb,"advanced_scale",T)end;ch.rotation=function(self,bn,ci)Utility.Cache.N3d[cb].rotation.rotation=bn;Utility.Cache.N3d[cb].rotation.syncedwithplayer=ci;s("Utility:Edit","N3d",cb,"rotation",{rotation=bn,syncedwithplayer=ci})end;ch.destroy=function(self)if Utility.Cache.N3d[cb].dui~=nil then DestroyDui(Utility.Cache.N3d[cb].dui)SetScaleformMovieAsNoLongerNeeded(cf)s("Utility:Remove","N3d",cb)end end;ch.started=function()return Utility.Cache.N3d[cb].dui~=nil end;ch.show=function(self,L,T)Utility.Cache.N3d[cb].coords=L;Utility.Cache.N3d[cb].scale=T or 0.1;Utility.Cache.N3d[cb].show=true;s("Utility:Edit","N3d",cb,"coords",L)s("Utility:Edit","N3d",cb,"scale",T or 0.1)s("Utility:Edit","N3d",cb,"show",true)end;ch.visible=function()return Utility.Cache.N3d[cb].show end;ch.hide=function()Utility.Cache.N3d[cb].show=false;s("Utility:Edit","N3d",cb,"show",false)end;ch.attach=function(self,a6,cj)Utility.Cache.N3d[cb].attach={entity=a6,offset=cj or vector3(0.0,0.0,0.0)}s("Utility:Edit","N3d",cb,"attach",{entity=a6,offset=cj or vector3(0.0,0.0,0.0)})end;ch.detach=function(self,ck)if ck then Utility.Cache.N3d[cb].coords=GetEntityCoords(Utility.Cache.N3d[cb].attach.entity)s("Utility:Edit","N3d",cb,"coords",Utility.Cache.N3d[cb].coords)end;Utility.Cache.N3d[cb].attach=nil;s("Utility:Edit","N3d",cb,"attach",nil)end;ch.object=function()return Utility.Cache.N3d[cb].dui end;ch.msg=function(self,K)if self:started()then SendDuiMessage(self:object(),json.encode(K))end end;return setmetatable({},ch)end;AddEventHandler("onResourceStop",function(cl)if cl==u then for cm,cn in pairs(Utility.Cache.N3d)do if cn.dui~=nil then DestroyDui(cn.dui)s("Utility:Remove","N3d",cm)end end end end)